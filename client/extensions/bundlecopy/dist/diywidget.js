'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.ready = exports.update = exports.$ = exports.template = void 0;
exports.template = `
<div class="component-container">
<ui-button type="success" class="uiFullButton">全屏</ui-button>
<ui-button type="success" class="horizontalFullButton">水平拉伸</ui-button>
<ui-button type="success" class="verticalFullButton">垂直拉伸</ui-button>
</div>
`;
exports.$ = {
    componentContainer: '.component-container',
    uiFullButton: ".uiFullButton",
    horizontalFullButton: ".horizontalFullButton",
    verticalFullButton: ".verticalFullButton",
};
function update(dump) {
    this.dump = dump;
}
exports.update = update;
function ready() {
    this.$.uiFullButton.addEventListener('click', (event) => {
        event.stopPropagation();
        console.log('uiFullButton');
        // console.log('node =', this.dump.value)
        // console.log('node uuid1=', this.dump.value.node)
        // console.log('node uuid2=', this.dump.value.node.value)
        // console.log('node uuid2=', this.dump.value.node.value.uuid)
        const nodeUUID = this.dump.value.node.value.uuid;
        OnFullWidget(nodeUUID);
    });
    this.$.horizontalFullButton.addEventListener('click', (event) => {
        event.stopPropagation();
        console.log('horizontalFullButton');
        const nodeUUID = this.dump.value.node.value.uuid;
        OnHorizontalWidget(nodeUUID);
    });
    this.$.verticalFullButton.addEventListener('click', (event) => {
        event.stopPropagation();
        console.log('verticalFullButton');
        const nodeUUID = this.dump.value.node.value.uuid;
        OnVerticalWidget(nodeUUID);
    });
}
exports.ready = ready;
async function OnFullWidget(nodeUUID) {
    const d1 = await Editor.Message.request('scene', 'query-node', nodeUUID);
    let index = 0, widgetIndex = 0;
    d1.__comps__.forEach(x => {
        // console.log('type=', x.type)
        if (x.type == 'cc.Widget') {
            widgetIndex = index;
        }
        index += 1;
    });
    // console.log('widgetIndex=', widgetIndex)
    let compStar = '__comps__.' + widgetIndex + '.';
    const alignPathArr = ['isAlignRight', 'isAlignLeft', 'isAlignTop', 'isAlignBottom'];
    const editorPathArr = ['editorLeft', 'editorRight', 'editorTop', 'editorBottom'];
    for (let index = 0; index < alignPathArr.length; index++) {
        const element = compStar + alignPathArr[index];
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Boolean',
                value: true,
            },
        });
    }
    for (let index = 0; index < editorPathArr.length; index++) {
        const element = compStar + editorPathArr[index];
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Number',
                value: 0,
            },
        });
    }
}
async function OnHorizontalWidget(nodeUUID) {
    const d1 = await Editor.Message.request('scene', 'query-node', nodeUUID);
    let index = 0, widgetIndex = 0;
    d1.__comps__.forEach(x => {
        // console.log('type=', x.type)
        if (x.type == 'cc.Widget') {
            widgetIndex = index;
        }
        index += 1;
    });
    // console.log('widgetIndex=', widgetIndex)
    let compStar = '__comps__.' + widgetIndex + '.';
    const alignPathArr = ['isAlignRight', 'isAlignLeft', 'isAlignTop', 'isAlignBottom'];
    const editorPathArr = ['editorLeft', 'editorRight', 'editorTop', 'editorBottom'];
    for (let index = 0; index < alignPathArr.length; index++) {
        const element = compStar + alignPathArr[index];
        const isFull = index < 2;
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Boolean',
                value: isFull,
            },
        });
    }
    for (let index = 0; index < editorPathArr.length - 2; index++) {
        const element = compStar + editorPathArr[index];
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Number',
                value: 0,
            },
        });
    }
}
async function OnVerticalWidget(nodeUUID) {
    const d1 = await Editor.Message.request('scene', 'query-node', nodeUUID);
    let index = 0, widgetIndex = 0;
    d1.__comps__.forEach(x => {
        // console.log('type=', x.type)
        if (x.type == 'cc.Widget') {
            widgetIndex = index;
        }
        index += 1;
    });
    // console.log('widgetIndex=', widgetIndex)
    let compStar = '__comps__.' + widgetIndex + '.';
    const alignPathArr = ['isAlignRight', 'isAlignLeft', 'isAlignTop', 'isAlignBottom'];
    const editorPathArr = ['editorLeft', 'editorRight', 'editorTop', 'editorBottom'];
    for (let index = 0; index < alignPathArr.length; index++) {
        const element = compStar + alignPathArr[index];
        const isFull = index > 1;
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Boolean',
                value: isFull,
            },
        });
    }
    for (let index = 2; index < editorPathArr.length; index++) {
        const element = compStar + editorPathArr[index];
        await Editor.Message.request('scene', 'set-property', {
            uuid: nodeUUID,
            path: element,
            dump: {
                type: 'Number',
                value: 0,
            },
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGl5d2lkZ2V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc291cmNlL2RpeXdpZGdldC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7OztBQUdBLFFBQUEsUUFBUSxHQUFHOzs7Ozs7Q0FNdkIsQ0FBQztBQUVXLFFBQUEsQ0FBQyxHQUFHO0lBQ2Isa0JBQWtCLEVBQUUsc0JBQXNCO0lBQzFDLFlBQVksRUFBRSxlQUFlO0lBQzdCLG9CQUFvQixFQUFFLHVCQUF1QjtJQUM3QyxrQkFBa0IsRUFBRSxxQkFBcUI7Q0FDNUMsQ0FBQztBQUVGLFNBQWdCLE1BQU0sQ0FBa0IsSUFBUztJQUU3QyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztBQUNyQixDQUFDO0FBSEQsd0JBR0M7QUFFRCxTQUFnQixLQUFLO0lBRWpCLElBQUksQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVUsRUFBRSxFQUFFO1FBQ3pELEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN4QixPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFBO1FBQzNCLHlDQUF5QztRQUN6QyxtREFBbUQ7UUFDbkQseURBQXlEO1FBQ3pELDhEQUE4RDtRQUU5RCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQTtRQUNoRCxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDMUIsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVUsRUFBRSxFQUFFO1FBQ2pFLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN4QixPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUE7UUFFbkMsTUFBTSxRQUFRLEdBQUcs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L0MsTUFBTSxNQUFNLEdBQUcsS0FBSyxHQUFHLENBQUMsQ0FBQTtRQUN4QixNQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxjQUFjLEVBQ2hEO1lBQ0ksSUFBSSxFQUFFLFFBQVE7WUFDZCxJQUFJLEVBQUUsT0FBTztZQUNiLElBQUksRUFBRTtnQkFDRixJQUFJLEVBQUUsU0FBUztnQkFDZixLQUFLLEVBQUUsTUFBTTthQUNoQjtTQUNKLENBQ0osQ0FBQztLQUNMO0lBQ0QsS0FBSyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsS0FBSyxHQUFHLGFBQWEsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEVBQUU7UUFDdkQsTUFBTSxPQUFPLEdBQUcsUUFBUSxHQUFHLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNoRCxNQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxjQUFjLEVBQ2hEO1lBQ0ksSUFBSSxFQUFFLFFBQVE7WUFDZCxJQUFJLEVBQUUsT0FBTztZQUNiLElBQUksRUFBRTtnQkFDRixJQUFJLEVBQUUsUUFBUTtnQkFDZCxLQUFLLEVBQUUsQ0FBQzthQUNYO1NBQ0osQ0FDSixDQUFDO0tBQ0w7QUFDTCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxudHlwZSBTZWxlY3RvcjwkPiA9IHsgJDogUmVjb3JkPGtleW9mICQsIGFueSB8IG51bGw+IH1cclxuZXhwb3J0IGNvbnN0IHRlbXBsYXRlID0gYFxyXG48ZGl2IGNsYXNzPVwiY29tcG9uZW50LWNvbnRhaW5lclwiPlxyXG48dWktYnV0dG9uIHR5cGU9XCJzdWNjZXNzXCIgY2xhc3M9XCJ1aUZ1bGxCdXR0b25cIj7lhajlsY88L3VpLWJ1dHRvbj5cclxuPHVpLWJ1dHRvbiB0eXBlPVwic3VjY2Vzc1wiIGNsYXNzPVwiaG9yaXpvbnRhbEZ1bGxCdXR0b25cIj7msLTlubPmi4nkvLg8L3VpLWJ1dHRvbj5cclxuPHVpLWJ1dHRvbiB0eXBlPVwic3VjY2Vzc1wiIGNsYXNzPVwidmVydGljYWxGdWxsQnV0dG9uXCI+5Z6C55u05ouJ5Ly4PC91aS1idXR0b24+XHJcbjwvZGl2PlxyXG5gO1xyXG5cclxuZXhwb3J0IGNvbnN0ICQgPSB7XHJcbiAgICBjb21wb25lbnRDb250YWluZXI6ICcuY29tcG9uZW50LWNvbnRhaW5lcicsXHJcbiAgICB1aUZ1bGxCdXR0b246IFwiLnVpRnVsbEJ1dHRvblwiLFxyXG4gICAgaG9yaXpvbnRhbEZ1bGxCdXR0b246IFwiLmhvcml6b250YWxGdWxsQnV0dG9uXCIsXHJcbiAgICB2ZXJ0aWNhbEZ1bGxCdXR0b246IFwiLnZlcnRpY2FsRnVsbEJ1dHRvblwiLFxyXG59O1xyXG50eXBlIFBhbmVsVGhpcyA9IFNlbGVjdG9yPHR5cGVvZiAkPiAmIHsgZHVtcDogYW55IH07XHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGUodGhpczogUGFuZWxUaGlzLCBkdW1wOiBhbnkpIHtcclxuXHJcbiAgICB0aGlzLmR1bXAgPSBkdW1wO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVhZHkodGhpczogUGFuZWxUaGlzKSB7XHJcblxyXG4gICAgdGhpcy4kLnVpRnVsbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudDogYW55KSA9PiB7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3VpRnVsbEJ1dHRvbicpXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ25vZGUgPScsIHRoaXMuZHVtcC52YWx1ZSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnbm9kZSB1dWlkMT0nLCB0aGlzLmR1bXAudmFsdWUubm9kZSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnbm9kZSB1dWlkMj0nLCB0aGlzLmR1bXAudmFsdWUubm9kZS52YWx1ZSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnbm9kZSB1dWlkMj0nLCB0aGlzLmR1bXAudmFsdWUubm9kZS52YWx1ZS51dWlkKVxyXG5cclxuICAgICAgICBjb25zdCBub2RlVVVJRCA9IHRoaXMuZHVtcC52YWx1ZS5ub2RlLnZhbHVlLnV1aWRcclxuICAgICAgICBPbkZ1bGxXaWRnZXQobm9kZVVVSUQpXHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLiQuaG9yaXpvbnRhbEZ1bGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQ6IGFueSkgPT4ge1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdob3Jpem9udGFsRnVsbEJ1dHRvbicpXHJcblxyXG4gICAgICAgIGNvbnN0IG5vZGVVVUlEID0gdGhpcy5kdW1wLnZhbHVlLm5vZGUudmFsdWUudXVpZFxyXG4gICAgICAgIE9uSG9yaXpvbnRhbFdpZGdldChub2RlVVVJRClcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuJC52ZXJ0aWNhbEZ1bGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQ6IGFueSkgPT4ge1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCd2ZXJ0aWNhbEZ1bGxCdXR0b24nKVxyXG5cclxuICAgICAgICBjb25zdCBub2RlVVVJRCA9IHRoaXMuZHVtcC52YWx1ZS5ub2RlLnZhbHVlLnV1aWRcclxuICAgICAgICBPblZlcnRpY2FsV2lkZ2V0KG5vZGVVVUlEKVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIE9uRnVsbFdpZGdldChub2RlVVVJRDogYW55KSB7XHJcblxyXG4gICAgY29uc3QgZDEgPSBhd2FpdCBFZGl0b3IuTWVzc2FnZS5yZXF1ZXN0KCdzY2VuZScsICdxdWVyeS1ub2RlJywgbm9kZVVVSUQpO1xyXG4gICAgbGV0IGluZGV4ID0gMCwgd2lkZ2V0SW5kZXggPSAwXHJcbiAgICBkMS5fX2NvbXBzX18uZm9yRWFjaCh4ID0+IHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygndHlwZT0nLCB4LnR5cGUpXHJcbiAgICAgICAgaWYgKHgudHlwZSA9PSAnY2MuV2lkZ2V0Jykge1xyXG4gICAgICAgICAgICB3aWRnZXRJbmRleCA9IGluZGV4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluZGV4ICs9IDFcclxuICAgIH0pXHJcbiAgICAvLyBjb25zb2xlLmxvZygnd2lkZ2V0SW5kZXg9Jywgd2lkZ2V0SW5kZXgpXHJcbiAgICBsZXQgY29tcFN0YXIgPSAnX19jb21wc19fLicgKyB3aWRnZXRJbmRleCArICcuJ1xyXG5cclxuICAgIGNvbnN0IGFsaWduUGF0aEFyciA9IFsnaXNBbGlnblJpZ2h0JywgJ2lzQWxpZ25MZWZ0JywgJ2lzQWxpZ25Ub3AnLCAnaXNBbGlnbkJvdHRvbSddXHJcbiAgICBjb25zdCBlZGl0b3JQYXRoQXJyID0gWydlZGl0b3JMZWZ0JywgJ2VkaXRvclJpZ2h0JywgJ2VkaXRvclRvcCcsICdlZGl0b3JCb3R0b20nXVxyXG5cclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhbGlnblBhdGhBcnIubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGNvbXBTdGFyICsgYWxpZ25QYXRoQXJyW2luZGV4XTtcclxuICAgICAgICBhd2FpdCBFZGl0b3IuTWVzc2FnZS5yZXF1ZXN0KCdzY2VuZScsICdzZXQtcHJvcGVydHknLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1dWlkOiBub2RlVVVJRCxcclxuICAgICAgICAgICAgICAgIHBhdGg6IGVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBkdW1wOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0Jvb2xlYW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGVkaXRvclBhdGhBcnIubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGNvbXBTdGFyICsgZWRpdG9yUGF0aEFycltpbmRleF07XHJcbiAgICAgICAgYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAnc2V0LXByb3BlcnR5JyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdXVpZDogbm9kZVVVSUQsXHJcbiAgICAgICAgICAgICAgICBwYXRoOiBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgZHVtcDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdOdW1iZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBPbkhvcml6b250YWxXaWRnZXQobm9kZVVVSUQ6IGFueSkge1xyXG5cclxuICAgIGNvbnN0IGQxID0gYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAncXVlcnktbm9kZScsIG5vZGVVVUlEKTtcclxuICAgIGxldCBpbmRleCA9IDAsIHdpZGdldEluZGV4ID0gMFxyXG4gICAgZDEuX19jb21wc19fLmZvckVhY2goeCA9PiB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3R5cGU9JywgeC50eXBlKVxyXG4gICAgICAgIGlmICh4LnR5cGUgPT0gJ2NjLldpZGdldCcpIHtcclxuICAgICAgICAgICAgd2lkZ2V0SW5kZXggPSBpbmRleFxyXG4gICAgICAgIH1cclxuICAgICAgICBpbmRleCArPSAxXHJcbiAgICB9KVxyXG4gICAgLy8gY29uc29sZS5sb2coJ3dpZGdldEluZGV4PScsIHdpZGdldEluZGV4KVxyXG4gICAgbGV0IGNvbXBTdGFyID0gJ19fY29tcHNfXy4nICsgd2lkZ2V0SW5kZXggKyAnLidcclxuXHJcbiAgICBjb25zdCBhbGlnblBhdGhBcnIgPSBbJ2lzQWxpZ25SaWdodCcsICdpc0FsaWduTGVmdCcsICdpc0FsaWduVG9wJywgJ2lzQWxpZ25Cb3R0b20nXVxyXG4gICAgY29uc3QgZWRpdG9yUGF0aEFyciA9IFsnZWRpdG9yTGVmdCcsICdlZGl0b3JSaWdodCcsICdlZGl0b3JUb3AnLCAnZWRpdG9yQm90dG9tJ11cclxuXHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgYWxpZ25QYXRoQXJyLmxlbmd0aDsgaW5kZXgrKykge1xyXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBjb21wU3RhciArIGFsaWduUGF0aEFycltpbmRleF07XHJcbiAgICAgICAgY29uc3QgaXNGdWxsID0gaW5kZXggPCAyXHJcbiAgICAgICAgYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAnc2V0LXByb3BlcnR5JyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdXVpZDogbm9kZVVVSUQsXHJcbiAgICAgICAgICAgICAgICBwYXRoOiBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgZHVtcDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdCb29sZWFuJyxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaXNGdWxsLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGVkaXRvclBhdGhBcnIubGVuZ3RoIC0gMjsgaW5kZXgrKykge1xyXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSBjb21wU3RhciArIGVkaXRvclBhdGhBcnJbaW5kZXhdO1xyXG4gICAgICAgIGF3YWl0IEVkaXRvci5NZXNzYWdlLnJlcXVlc3QoJ3NjZW5lJywgJ3NldC1wcm9wZXJ0eScsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHV1aWQ6IG5vZGVVVUlELFxyXG4gICAgICAgICAgICAgICAgcGF0aDogZWxlbWVudCxcclxuICAgICAgICAgICAgICAgIGR1bXA6IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTnVtYmVyJyxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMCxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gT25WZXJ0aWNhbFdpZGdldChub2RlVVVJRDogYW55KSB7XHJcblxyXG4gICAgY29uc3QgZDEgPSBhd2FpdCBFZGl0b3IuTWVzc2FnZS5yZXF1ZXN0KCdzY2VuZScsICdxdWVyeS1ub2RlJywgbm9kZVVVSUQpO1xyXG4gICAgbGV0IGluZGV4ID0gMCwgd2lkZ2V0SW5kZXggPSAwXHJcbiAgICBkMS5fX2NvbXBzX18uZm9yRWFjaCh4ID0+IHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygndHlwZT0nLCB4LnR5cGUpXHJcbiAgICAgICAgaWYgKHgudHlwZSA9PSAnY2MuV2lkZ2V0Jykge1xyXG4gICAgICAgICAgICB3aWRnZXRJbmRleCA9IGluZGV4XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGluZGV4ICs9IDFcclxuICAgIH0pXHJcbiAgICAvLyBjb25zb2xlLmxvZygnd2lkZ2V0SW5kZXg9Jywgd2lkZ2V0SW5kZXgpXHJcbiAgICBsZXQgY29tcFN0YXIgPSAnX19jb21wc19fLicgKyB3aWRnZXRJbmRleCArICcuJ1xyXG5cclxuICAgIGNvbnN0IGFsaWduUGF0aEFyciA9IFsnaXNBbGlnblJpZ2h0JywgJ2lzQWxpZ25MZWZ0JywgJ2lzQWxpZ25Ub3AnLCAnaXNBbGlnbkJvdHRvbSddXHJcbiAgICBjb25zdCBlZGl0b3JQYXRoQXJyID0gWydlZGl0b3JMZWZ0JywgJ2VkaXRvclJpZ2h0JywgJ2VkaXRvclRvcCcsICdlZGl0b3JCb3R0b20nXVxyXG5cclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhbGlnblBhdGhBcnIubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGNvbXBTdGFyICsgYWxpZ25QYXRoQXJyW2luZGV4XTtcclxuICAgICAgICBjb25zdCBpc0Z1bGwgPSBpbmRleCA+IDFcclxuICAgICAgICBhd2FpdCBFZGl0b3IuTWVzc2FnZS5yZXF1ZXN0KCdzY2VuZScsICdzZXQtcHJvcGVydHknLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1dWlkOiBub2RlVVVJRCxcclxuICAgICAgICAgICAgICAgIHBhdGg6IGVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBkdW1wOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0Jvb2xlYW4nLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpc0Z1bGwsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDI7IGluZGV4IDwgZWRpdG9yUGF0aEFyci5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gY29tcFN0YXIgKyBlZGl0b3JQYXRoQXJyW2luZGV4XTtcclxuICAgICAgICBhd2FpdCBFZGl0b3IuTWVzc2FnZS5yZXF1ZXN0KCdzY2VuZScsICdzZXQtcHJvcGVydHknLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1dWlkOiBub2RlVVVJRCxcclxuICAgICAgICAgICAgICAgIHBhdGg6IGVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBkdW1wOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ051bWJlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0iXX0=